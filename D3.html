<!DOCTYPE html>
<html>
<head>
	<title>For D3 practice</title>
	<meta charset="utf-8">
	<script type="text/javascript" src="d3/d3.js"></script>


	<style>
		div.bar {
			display: inline-block;
			width: 20px;
			height: 75px;
			background-color: red;
			margin-right: 2px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.axis text {
			font-family: sans-serif;
			font-size: 14px;
		}
	</style>


</head>
<body>

	<div class="bar"> 
	</div>
	<p> Hey! Im here!</p>
	
	<script type="text/javascript">
		var dataset = [1,3,5,7,11]
		
		//d3.csv("Soccer_2017.csv", function(data){
		//	console.log(data[1].AWAYTEAM)});
		
//數字
		d3.select("body")
			.selectAll("p")
			.data(dataset)
			.enter()
			.append("p")
			.text(function(d){return d;})
			.style("color", function(d){
				if(d > 5){
					return "red"
				} else {
					return "green"
				}
			});


var dataset1 = [5,10,15,20,25, 18, 33, 5, 10, 20, 17, 22,
			   10,15,20,25, 18, 33, 5, 10, 20, 17, 22];

//圓形
/*
		var svg = d3.select("body").append("svg")
				.attr("width", 500)
				.attr("height", 200)

		var circle = svg.selectAll("circle")
			.data(dataset1)
			.enter()
			.append("circle")
			.attr("cx", function(d,i){
				return (i*50) + 25;
			})
			.attr("cy", 25)
			.attr("r", function(d){
				return d;
			})

		circle.attr("fill", "yellow")
			  .attr("stroke", "orange")
			  .attr("stroke-width", function(d){
			  	return d / 3;
			  })
*/

// 長條圖
		var w = 600;
		var h = 600;
		var padding = 50;
		/* SVG for histogram*/
		var Xscale_or = d3.scaleBand()
						  .domain(d3.range(dataset1.length))
						  .rangeRound([0, w])
						  .paddingInner(0.05)
						  .paddingOuter(.5);

		var Yscale_or = d3.scaleLinear()
					      .domain([0, d3.max(dataset1)])
					      .range([0, h - padding]);


		var rect = d3.select("body").append("svg")
					 .attr("width", w)
					 .attr("height", h);

			rect.selectAll("rect")
				.data(dataset1)
				.enter()
				.append("rect")
				.attr("x", function(d, i){
					return Xscale_or(i);
				})
				.attr("y", function(d){
					return h - Yscale_or(d) -20;
				})
				.attr("width", Xscale_or.bandwidth())
				.attr("height", function(d){
					return Yscale_or(d);
				})
				.attr("fill", function(d){
					return "rgb(0, 0, " + (d*10) + ")";
				});

			rect.selectAll("text")
				.data(dataset1)
				.enter()
				.append("text")
				.text(function(d){
					return d;
				})
				.attr("x", function(d, i){
					return Xscale_or(i) + Xscale_or.bandwidth()/2;
				})
				.attr("y", function(d){
					return h - Yscale_or(d);
				})
				.attr("font-family", "sans-serif")
				.attr("font-size", "11px")
				.attr("fill", "white")
				.attr("text-anchor", "middle");

			d3.select("p").on("click", function(){
	
				dataset1 = [15,210,315,120,125, 218, 33, 111, 210, 220, 17, 22,
			   			    102,125,20,25, 218, 233, 35, 122, 320, 317, 22];
			   	//上限被寫成hard code，這點看日後有沒有辦法改進。
			   	var Yscale_or = d3.scaleLinear()
					      .domain([0, d3.max(dataset1)])
					      .range([0, h - padding]);

			   	rect.selectAll("rect")
			   		.data(dataset1)
			   		.transition()
			   		.duration(1000)
			   		.attr("y", function(d){
						return h - Yscale_or(d) -20;
					})
					.attr("height", function(d){
						return Yscale_or(d);
					})
					.attr("fill", function(d){
						return "rgb(0, 0, " + (d*5) + ")";
					});

				rect.selectAll("text")
					.data(dataset1)
					.transition()
			   		.duration(5000)
					.text(function(d){
						return d;
					})
					.attr("x", function(d, i){
						return Xscale_or(i) + Xscale_or.bandwidth()/2;
					})
					.attr("y", function(d){
						return h - Yscale_or(d);
					})
					.attr("font-family", "sans-serif")
					.attr("font-size", "11px")
					.attr("fill", "white")
					.attr("text-anchor", "middle");



			});



//散布圖
// Scale example

		/*
		var dataset2 = [	
			[ 10, 14],
			[122, 24],
			[313, 43],
			[254, 41],
			[16, 154],
			[161, 44],
			[281, 49],
			[461, 94],
			[800, 200]
		];
		*/
		var dataset2 =[];
		var num = 50;
		var xRange = Math.random() * 1000;
		var yRange = Math.random() * 1000;
		for(var i = 0; i <= num; i++) {
			var newNum1 = Math.floor(Math.random() * xRange);
			var newNum2 = Math.floor(Math.random() * yRange);
			dataset2.push([newNum1, newNum2]);
		};


		var Xscale = d3.scaleLinear()
							.domain([0, d3.max(dataset2, function(d) {return d[0]; })])
							.range([padding, w-padding]);

		var Yscale = d3.scaleLinear()
							.domain([0, d3.max(dataset2, function(d) {return d[1]; })])
							.range([h-padding, padding]);

		var Rscale = d3.scaleLinear()
							.domain([0, d3.max(dataset2, function(d) {return d[1]; })])
							.range([1, 10]);


		var svg_cir = d3.select("body").append("svg")
					.attr("width", w)
					.attr("height", h);

			svg_cir.selectAll("circle")
				   .data(dataset2)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d){
				   	return Xscale(d[0]);
				   })
				   .attr("cy", function(d){
				   	return Yscale(d[1]);
				   })
				   .attr("r", function(d){
				   	return Rscale(d[1]);
				   });
			svg_cir.selectAll("text")
				   .data(dataset2)
				   .enter()
				   .append("text")
				   .text(function(d) {
				   	return d[0] + "," + d[1];
				   })
				   .attr("x", function(d){
				   	return Xscale(d[0]);
				   })
				   .attr("y", function(d){
				   	return Yscale(d[1]);
				   })
				   .attr("fill", "red")
				   .attr("font-family", "sans-serif")
				   .attr("font-size", "11px");

		var tickFormat = d3.format(".1%")
		var xAxis = d3.axisBottom()
					  .scale(Xscale);
					  //.tickFormat(tickFormat)

		var yAxis = d3.axisLeft()
					  .scale(Yscale);


			svg_cir.append("g")
				   .attr("class", "axis")
				   .attr("transform", "translate(0," + (h-padding) + ")")
				   .call(xAxis);

			svg_cir.append("g")
				   .attr("class", "axis")
				   .attr("transform", "translate(" + (padding-15) + ", 0)")
				   .call(yAxis);




		
	</script>


</body>
</html>